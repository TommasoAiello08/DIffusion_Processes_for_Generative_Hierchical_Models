# Diffusion Processes for Generative Hierarchical Models

[![Python 3.9+](https://img.shields.io/badge/python-3.9+-blue.svg)](https://www.python.org/downloads/)
[![PyTorch](https://img.shields.io/badge/PyTorch-2.0+-red.svg)](https://pytorch.org/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

This repository accompanies a thesis investigating **phase transitions in denoising diffusion models** applied to hierarchical data generated by formal grammars.

## ğŸ¯ Overview

This work investigates the claim from *"A Phase Transition in Diffusion Models Reveals the Hierarchical Nature of Data"* by Sclocchi, Favero, and Wyart, empirically examining whether phase transitions occur generally across hierarchical structures.

The repository provides a **clean, reproducible framework** using **Random Hierarchical Models (RHMs)**, where synthetic data is generated by context-free grammars. By studying how diffusion models denoise these sequences, we probe the interplay between **hierarchy, noise, and reconstruction accuracy**.

## ğŸ“ Repository Structure

```
.
â”œâ”€â”€ src/                          # Core source code (modular & documented)
â”‚   â”œâ”€â”€ grammar.py               # Hierarchical data generation
â”‚   â”œâ”€â”€ diffusion.py             # Forward diffusion process
â”‚   â”œâ”€â”€ models.py                # Transformer-based denoisers
â”‚   â””â”€â”€ utils.py                 # Grammar constraints & utilities
â”‚
â”œâ”€â”€ experiments/                  # Experiment runners
â”‚   â””â”€â”€ run_experiment.py        # Main experiment pipeline
â”‚
â”œâ”€â”€ configs/                      # Configuration files
â”‚   â”œâ”€â”€ grammars.py              # Grammar specifications
â”‚   â””â”€â”€ experiment_config.py     # Experiment configurations
â”‚
â”œâ”€â”€ notebooks/                    # Clean tutorial notebooks
â”‚   â””â”€â”€ 01_getting_started.ipynb
â”‚
â”œâ”€â”€ data/                         # Generated data (gitignored)
â”œâ”€â”€ outputs/                      # Experiment results (gitignored)
â”œâ”€â”€ requirements.txt              # Python dependencies
â””â”€â”€ README.md
```

## ğŸš€ Quick Start

### Installation

```bash
git clone https://github.com/TommasoAiello08/DIffusion_Processes_for_Generative_Hierchical_Models.git
cd DIffusion_Processes_for_Generative_Hierchical_Models
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
pip install -r requirements.txt
```

### Run Your First Experiment

```bash
python experiments/run_experiment.py
```

This will:
1. Generate 1000 synthetic hierarchical sequences
2. Apply forward diffusion (add noise)
3. Train a Transformer denoiser
4. Save results to `outputs/`

### Explore the Notebooks

```bash
jupyter notebook notebooks/01_getting_started.ipynb
```

## ğŸ”¬ Key Features

- **Modular Architecture**: Clean separation of concerns (data, models, training, evaluation)
- **Configurable Experiments**: Easy-to-modify configuration files
- **Multiple Grammars**: Binary and multi-level hierarchical structures
- **Grammar Constraints**: Built-in support for enforcing hierarchical rules
- **Visualization Tools**: Plot accuracy evolution, phase transitions, and more

## ğŸ“Š Research Summary

### Implemented
- Synthetic corpora using RHMs with binary and variable-branch grammars
- Transformer-based denoising diffusion models
- Analysis of memorization vs. generalization regimes
- Multiple noise schedules (exponential, cosine)

### Key Findings
- Observed survival-speciation-drift regimes in reconstruction
- Investigated how branching topology and sample size affect denoising
- Studied phase transition behavior under different conditions

## ğŸ“ Citation

```bibtex
@mastersthesis{aiello2025diffusion,
  author  = {Tommaso Aiello},
  title   = {Diffusion Processes for Generative Hierarchical Models},
  school  = {[Your University]},
  year    = {2025}
}
```

## ğŸ¤ Contributing

Suggestions and improvements welcome! Open issues or submit PRs.

## ğŸ“„ License

MIT License - see LICENSE file for details.

---

**Author**: Tommaso Aiello  
**Date**: December 2025
